import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o as i,c as u,d as r,w as a,e as o,b as s,a as n}from"./app-2b248397.js";const k={},d=o(`<h1 id="读取excel爬取对应网站生成导航信息" tabindex="-1"><a class="header-anchor" href="#读取excel爬取对应网站生成导航信息" aria-hidden="true">#</a> 读取excel爬取对应网站生成导航信息</h1><h2 id="为什么要做这个" tabindex="-1"><a class="header-anchor" href="#为什么要做这个" aria-hidden="true">#</a> 为什么要做这个？</h2><p>我的博客中的导航page是通过手动添加链接，然后去对应网站控制台抓取对应图标，手动写到 markdown 文件中的，维护成本过高。</p><h2 id="我要做什么" tabindex="-1"><a class="header-anchor" href="#我要做什么" aria-hidden="true">#</a> 我要做什么？</h2><p>使用excel维护网站导航列表，通过代码读取excel自动去对应网站抓取我需要的东西，然后生成markdown文件，并可以进行增量式更新，后续我只需要维护excel表就可以</p><h2 id="理论成型-实践开始" tabindex="-1"><a class="header-anchor" href="#理论成型-实践开始" aria-hidden="true">#</a> 理论成型，实践开始</h2><h3 id="_1-设计excel表格" tabindex="-1"><a class="header-anchor" href="#_1-设计excel表格" aria-hidden="true">#</a> 1.设计excel表格</h3><ol><li>一个导航需要三个信息，站点名称，站点描述，站点链接</li><li>将导航分成两级分类，第一级sheet分文件，将前端，golang，友情链接，第二季分类再表格中体现，按导航的作用分类</li></ol><figure><img src="https://chart-1253420647.cos.ap-beijing.myqcloud.com/markdown/image-20230927174903929.png" alt="设计 excel 表格" tabindex="0" loading="lazy"><figcaption>设计 excel 表格</figcaption></figure><h3 id="_2-设计数据结构" tabindex="-1"><a class="header-anchor" href="#_2-设计数据结构" aria-hidden="true">#</a> 2.设计数据结构</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;前端&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;vue及其生态&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;vue及其生态&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;golang&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;其他&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">desc</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">link</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-解析excel-组合数据" tabindex="-1"><a class="header-anchor" href="#_3-解析excel-组合数据" aria-hidden="true">#</a> 3.解析excel,组合数据</h3><p>步骤：</p><ol><li>使用 node-xlsx 解析 excel，并处理成上面的数据结构</li><li>使用 axios 配合 cheerio 向网站发送请求并抓取网站使用的 icon</li><li>将最终结果组合成 markdown</li></ol><p>优化：</p><ol><li>为了防止重复发送请求，我将对应网站的 icon 转换成了 base64 存储到了 txt 文件中，每次重新生成导航文件，都会先判断对应网站的 icon 是否下载过，只有没有下载的文件才会重新发送请求</li><li>icon 取的是标签栏的小图标，有些网站没有小图标，我生成一个默认的图标</li><li>在开发过程中发现将 .ico 后缀的文件转换成 .png 后缀的文件，图片大小相对较小，所以我将 ico 图标转换成了 png</li></ol><p>整体代码如下：</p>`,17),m=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" xlsx "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"node-xlsx"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" getIcon"),n("span",{class:"token punctuation"},","),s(" genTemplate "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"./utils.js"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" fs "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"fs"'),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// 创建临时文件夹"),s(`
fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"mkdirSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'temp'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"recursive"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 判断icon目录是否存在"),s(`
`),n("span",{class:"token keyword"},"let"),s(" defaultIcon "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjk1NzMyOTgyMTA3IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE3MjYiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik00MTUuNTkwNCA0MjkuNjE5MmM1OS42OTkyIDEwMC4xOTg0IDEzMS4zMjggMTg2LjIxNDQgMjE0LjM3NDQgMjU3Ljc0MDggNDEuNjI1Ni02Ny4yMjU2IDc2LjA4MzItMTM0LjU1MzYgMTAzLjg4NDgtMTk1LjQ4MTYtNS4xMi01LjEyLTkuMzY5Ni0xMS4xMTA0LTEyLjY5NzYtMTcuNjY0LTExOS4zOTg0LTQuNjA4LTIyMS4yODY0LTIyLjA2NzItMzA1LjU2MTYtNDQuNTk1MnpNNzg2Ljg5MjggNTExLjc5NTJjLTI5Ljg0OTYgNjUuNjg5Ni02Ny4yMjU2IDEzOC43MDA4LTExMi43OTM2IDIxMS41MDcyIDQ0LjAzMiAzMy42Mzg0IDkwLjk4MjQgNjMuNTM5MiAxNDAuNzQ4OCA4OS42NTEyIDc5LjAwMTYtNzguMDggMTI3Ljk0ODgtMTg2LjUyMTYgMTI3Ljk0ODgtMzA2LjMyOTYgMC0xMy4wMDQ4LTAuNjE0NC0yNS45MDcyLTEuNzQwOC0zOC42MDQ4LTMzLjQ4NDggMy4wMjA4LTY2LjA0OCA1LjA2ODgtOTcuNDg0OCA2LjE5NTItMTAuNjQ5NiAyMS4wOTQ0LTMxLjg0NjQgMzUuOTQyNC01Ni42Nzg0IDM3LjU4MDh6TTM1My41MzYgMzEwLjIyMDhjMC41NjMyIDAgMS4wNzUyLTAuMTAyNCAxLjYzODQtMC4xMDI0IDM3LjA2ODggMCA2Ny41MzI4IDI3Ljk1NTIgNzEuNjI4OCA2My45NDg4IDgwLjE3OTIgMjEuNzA4OCAxNzcuNTEwNCAzOC43NTg0IDI5Mi4xOTg0IDQzLjQ2ODggMTAuMjQtMjQuOTM0NCAzNC43MTM2LTQyLjU0NzIgNjMuMzg1Ni00Mi41NDcyIDAuMjA0OCAwIDAuNDA5NiAwLjA1MTIgMC42MTQ0IDAuMDUxMiAyMi41MjgtNTguNDE5MiAzOS45ODcyLTExMC44OTkyIDUyLjczNi0xNTIuNjI3MkM3NTYuNzg3MiAxMzIuNTU2OCA2NDEuMDI0IDc1LjgyNzIgNTEyIDc1LjgyNzJjLTgwLjU4ODggMC0xNTYuMDU3NiAyMi4xNjk2LTIyMC41Njk2IDYwLjcyMzIgMTEuNTIgNDMuMDA4IDMwLjkyNDggMTA0LjE5MiA2Mi4xMDU2IDE3My42NzA0ek05MzIuMzUyIDQxMi4xMDg4Yy0xMC43NTItNDguMTI4LTI5LjU5MzYtOTMuMTg0LTU0Ljk4ODgtMTMzLjc4NTZhMjMzNi4yMDQ4IDIzMzYuMjA0OCAwIDAgMS00My4wNTkyIDEyMC42MjcyYzQuNzYxNiA1LjUyOTYgOC42NTI4IDExLjgyNzIgMTEuNDE3NiAxOC42ODhhMTc1OC4yMDggMTc1OC4yMDggMCAwIDAgODYuNjMwNC01LjUyOTZ6TTY0My43ODg4IDc2OS44OTQ0Yy0zOS42Mjg4IDU4LjQxOTItODQuNzM2IDExNS42MDk2LTEzNS40MjQgMTY3LjQyNCAxLjIyODggMCAyLjQwNjQgMC4wNTEyIDMuNjM1MiAwLjA1MTIgOTYuNTEyIDAgMTg1LjY1MTItMzEuNzQ0IDI1Ny40MzM2LTg1LjM1MDQtNDUuNTY4LTI1LjM5NTItODcuMzk4NC01Mi45OTItMTI1LjY0NDgtODIuMTI0OHpNNTk5LjY1NDQgNzM0LjQ2NGMtMTA3LjA1OTItOTAuODgtMTgyLjg4NjQtMTkyLTIzNS40MTc2LTI4MC43Mjk2LTIuOTY5NiAwLjM1ODQtNS45OTA0IDAuNjE0NC05LjA2MjQgMC42MTQ0LTM4LjcwNzIgMC03MC4xNDQtMzAuNTE1Mi03MS45MzYtNjguNzYxNi0wLjkyMTYtMC4zNTg0LTEuODQzMi0wLjcxNjgtMi43MTM2LTEuMDc1Mi02MS42OTYtMjUuMTM5Mi0xMTEuNjY3Mi01Mi4yMjQtMTUwLjczMjgtNzYuOC0zMS4wMjcyIDU5LjQ5NDQtNDguNTg4OCAxMjcuMTgwOC00OC41ODg4IDE5OC45MTIgMCAyMTEuNTA3MiAxNTIuMzcxMiAzODcuMzc5MiAzNTMuMzgyNCA0MjMuODMzNiA2My4xMjk2LTU4LjI2NTYgMTE4LjAxNi0xMjYuMTU2OCAxNjUuMDY4OC0xOTUuOTkzNnpNMzAxLjI2MDggMzMxLjkyOTZjLTI3Ljk1NTItNjIuMzEwNC00Ni43OTY4LTExOC4wMTYtNTkuMTM2LTE2MS4wNzUyQTQzMi45OTg0IDQzMi45OTg0IDAgMCAwIDE1OS4yMzIgMjU5LjMyOGMzNi41NTY4IDIzLjA5MTIgODMuNzYzMiA0OC43OTM2IDE0Mi4wMjg4IDcyLjYwMTZ6IiBmaWxsPSIjNTA1NTg3IiBwLWlkPSIxNzI3Ij48L3BhdGg+PC9zdmc+"'),s(`
`),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("fs"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"existsSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"icon"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 如果目录不存在，则创建目录"),s(`
    fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"mkdirSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"icon"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"recursive"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"writeFileSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"icon/default.txt"'),n("span",{class:"token punctuation"},","),s(" defaultIcon"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 判断 output 目录是否存在，如果不存在，则创建 output 目录"),s(`
`),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("fs"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"existsSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"output"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// 如果目录不存在，则创建目录"),s(`
    fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"mkdirSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"output"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"recursive"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"const"),s(" workSheetsFromFile "),n("span",{class:"token operator"},"="),s(" xlsx"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("__dirname"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},"/网站导航.xlsx"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"let"),s(" data "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token keyword"},"let"),s(" completeCount "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(`
workSheetsFromFile`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("item"),n("span",{class:"token punctuation"},","),s("index")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("data"),n("span",{class:"token punctuation"},"["),s("item"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(" data"),n("span",{class:"token punctuation"},"["),s("item"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(" item"),n("span",{class:"token punctuation"},"."),s("data"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"let"),s(),n("span",{class:"token punctuation"},"["),s("title"),n("span",{class:"token punctuation"},","),s("desc"),n("span",{class:"token punctuation"},","),s("link"),n("span",{class:"token punctuation"},","),s("category"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(" item"),n("span",{class:"token punctuation"},"."),s("data"),n("span",{class:"token punctuation"},"["),s("i"),n("span",{class:"token punctuation"},"]"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("category"),n("span",{class:"token punctuation"},")"),s(" category "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"其他"'),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("data"),n("span",{class:"token punctuation"},"["),s("item"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),s("category"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(" data"),n("span",{class:"token punctuation"},"["),s("item"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),s("category"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
        `),n("span",{class:"token keyword"},"let"),s(" icon "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"getIcon"),n("span",{class:"token punctuation"},"("),s("link"),n("span",{class:"token punctuation"},")"),s(`
        data`),n("span",{class:"token punctuation"},"["),s("item"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),s("category"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
            title`),n("span",{class:"token punctuation"},","),s(`
            desc`),n("span",{class:"token punctuation"},","),s(`
            icon`),n("span",{class:"token punctuation"},","),s(`
            link
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    completeCount`),n("span",{class:"token operator"},"++"),s(`
    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("completeCount"),n("span",{class:"token punctuation"},","),s("workSheetsFromFile"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("completeCount "),n("span",{class:"token operator"},"==="),s(" workSheetsFromFile"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 处理完成数量等于总sheet数"),s(`
        `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" key "),n("span",{class:"token keyword"},"in"),s(" data"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"let"),s(" result "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},`---
article: false
sidebar: false
breadcrumb: false
pageInfo: false
editLink: false
---

# `),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("key"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},`
            `),n("span",{class:"token template-punctuation string"},"`")]),s(`
            `),n("span",{class:"token keyword"},"for"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" key1 "),n("span",{class:"token keyword"},"in"),s(" data"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                result `),n("span",{class:"token operator"},"+="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},`

## `),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("key1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},`
<div class="vp-card-container">
                `),n("span",{class:"token template-punctuation string"},"`")]),s(`
                data`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"["),s("key1"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"item"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},"."),s("title "),n("span",{class:"token operator"},"&&"),s(" item"),n("span",{class:"token punctuation"},"."),s("link "),n("span",{class:"token operator"},"&&"),s(" item"),n("span",{class:"token punctuation"},"."),s("icon"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                        `),n("span",{class:"token keyword"},"let"),s(" content "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"genTemplate"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},"."),s("title"),n("span",{class:"token punctuation"},","),s("item"),n("span",{class:"token punctuation"},"."),s("desc "),n("span",{class:"token operator"},"||"),s(),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},","),s("item"),n("span",{class:"token punctuation"},"."),s("link"),n("span",{class:"token punctuation"},","),s("item"),n("span",{class:"token punctuation"},"."),s("icon"),n("span",{class:"token punctuation"},")"),s(`
                        result `),n("span",{class:"token operator"},"+="),s(` content
                    `),n("span",{class:"token punctuation"},"}"),s(`
                `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
                result `),n("span",{class:"token operator"},"+="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"</div>"),n("span",{class:"token template-punctuation string"},"`")]),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
            
            fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"writeFile"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"output/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("key"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".md"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},","),s(" result"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("key"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".md写入文件失败:"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},","),s(" err"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
                  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("key"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".md写入成功"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

        `),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token comment"},"// 删除临时文件夹"),s(`
        fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"rm"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'temp'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"recursive"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'临时文件删除失败'"),n("span",{class:"token punctuation"},","),s(" err"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
                `),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},";"),s(`
            `),n("span",{class:"token punctuation"},"}"),s(`
            console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'临时文件删除成功'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),g=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" axios "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"axios"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" cheerio "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'cheerio'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"const"),s(" fs "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"fs"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" https "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'https'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token constant"},"ICO"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"require"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"icojs"'),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(" agent "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},[s("https"),n("span",{class:"token punctuation"},"."),s("Agent")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"rejectUnauthorized"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token comment"},"// 发送请求获取网站icon"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"request"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"url"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" option "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'.svg'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        option`),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"responseType"'),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'arraybuffer'"),s(`
        option`),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"httpsAgent"'),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` agent
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" response "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" axios"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},","),s("option"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"return"),s(` response
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 从域名中获取协议"),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getProtocolFromUrl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"url"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token string"},"''"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" regex "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token regex"},[n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-source language-regex"},"^(https?)"),n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-flags"},"i")]),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" match "),n("span",{class:"token operator"},"="),s(" url"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"match"),n("span",{class:"token punctuation"},"("),s("regex"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" match"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 从域名中获取域名"),s(`
`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getDomainFromUrl"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"url"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token string"},"''"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" regex "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token regex"},[n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-source language-regex"},"^https?:\\/\\/([^\\/]+)"),n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-flags"},"i")]),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" match "),n("span",{class:"token operator"},"="),s(" url"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"match"),n("span",{class:"token punctuation"},"("),s("regex"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" match"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"imgUrl"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("url"),n("span",{class:"token punctuation"},","),s("data")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'".ico"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"let"),s(" icoName "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"temp/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Date"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"getTime"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),s(`
        fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"writeFileSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("icoName"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".ico"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},","),s("data"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"const"),s(" buffer "),n("span",{class:"token operator"},"="),s(" fs"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"readFileSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("icoName"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".ico"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"let"),s(" result "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),s(`
        `),n("span",{class:"token keyword"},"let"),s(" images "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token constant"},"ICO"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),s("buffer"),n("span",{class:"token punctuation"},","),n("span",{class:"token string"},'"image/png"'),n("span",{class:"token punctuation"},")"),s(`
        images`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),s(),n("span",{class:"token parameter"},"image"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"const"),s(" bufferdata "),n("span",{class:"token operator"},"="),s(" Buffer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("image"),n("span",{class:"token punctuation"},"."),s("buffer"),n("span",{class:"token punctuation"},")"),s(`
            result `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"data:image/png;base64,"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("bufferdata"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"base64"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(` result
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'.svg'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 非svg"),s(`
        `),n("span",{class:"token comment"},'// saveIcon(getDomainFromUrl(url),`data:image/png;base64,${Buffer.from(data).toString("base64")}`)'),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"data:image/png;base64,"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("Buffer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"base64"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// svg"),s(`
        `),n("span",{class:"token comment"},'// saveIcon(getDomainFromUrl(url),`data:image/svg+xml;base64,${Buffer.from(data).toString("base64")}`)'),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"data:image/svg+xml;base64,"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("Buffer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"base64"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"getIcon"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"url"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("url"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" protocol "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getProtocolFromUrl"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" domain "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getDomainFromUrl"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 查看 icon 是否已经被存储，如果被存储，则从存储中取出"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" readResult "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getIconContent"),n("span",{class:"token punctuation"},"("),s("domain"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("readResult "),n("span",{class:"token operator"},"==="),s(),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"getIconContent"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'default'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("readResult"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(` readResult
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" response "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"null"),s(`
    `),n("span",{class:"token keyword"},"try"),s(),n("span",{class:"token punctuation"},"{"),s(`
        response `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"request"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"catch"),s(),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"网站无法访问,保存空文件夹，防止后续重新发送请求"'),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token function"},"saveIcon"),n("span",{class:"token punctuation"},"("),s("domain"),n("span",{class:"token punctuation"},","),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"getIconContent"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'default'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" $ "),n("span",{class:"token operator"},"="),s(" cheerio"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"load"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"String"),n("span",{class:"token punctuation"},"("),s("response"),n("span",{class:"token punctuation"},"."),s("data"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" iconUrl "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),s(`
    `),n("span",{class:"token comment"},`// console.log("link-length:",$('link').length)`),s(`
    `),n("span",{class:"token function"},"$"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'link'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"function"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("i"),n("span",{class:"token punctuation"},","),s("el")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 如果地址已经存在，跳过当前循环"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("iconUrl"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`
        `),n("span",{class:"token comment"},'// if ($(this).attr("rel").toLowerCase().indexOf("icon") !== -1) {}'),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"$"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"rel"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toLowerCase"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"icon"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            href `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"$"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"this"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"prop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"href"'),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("href"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"indexOf"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"http"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token comment"},"// 跟当前链接域名不同"),s(`
                iconUrl `),n("span",{class:"token operator"},"="),s(` href
            `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("href"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"//"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token comment"},'// 判断链接是否以 "//" 开头,像站酷之类的网站'),s(`
                iconUrl `),n("span",{class:"token operator"},"="),s(" protocol "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'":"'),s(),n("span",{class:"token operator"},"+"),s(` href
            `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
                iconUrl `),n("span",{class:"token operator"},"="),s(" protocol "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"://"'),s(),n("span",{class:"token operator"},"+"),s(" domain "),n("span",{class:"token operator"},"+"),s(` href
            `),n("span",{class:"token punctuation"},"}"),s(`
            `),n("span",{class:"token keyword"},"return"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(` 
        `),n("span",{class:"token comment"},'// console.log("数组长度",$("link").length,"===","当前是：",i)'),s(`
        `),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"$"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"link"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token operator"},"==="),s(" i "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"!"),s("iconUrl"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token comment"},"// 查看默认图标是否设置"),s(`
            `),n("span",{class:"token comment"},'// console.log("没有在代码中明显标出",url)'),s(`
            iconUrl `),n("span",{class:"token operator"},"="),s(" protocol "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"://"'),s(),n("span",{class:"token operator"},"+"),s(" domain "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"/favicon.ico"'),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" iconResponse "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"null"),s(`
    `),n("span",{class:"token keyword"},"try"),s(),n("span",{class:"token punctuation"},"{"),s(`
        iconResponse `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"request"),n("span",{class:"token punctuation"},"("),s("iconUrl"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"catch"),s(),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"saveIcon"),n("span",{class:"token punctuation"},"("),s("domain"),n("span",{class:"token punctuation"},","),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"getIconContent"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'default'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" imgBase64Url "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"imgUrl"),n("span",{class:"token punctuation"},"("),s("iconUrl"),n("span",{class:"token punctuation"},","),s("iconResponse"),n("span",{class:"token punctuation"},"."),s("data"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"saveIcon"),n("span",{class:"token punctuation"},"("),s("domain"),n("span",{class:"token punctuation"},","),s("imgBase64Url"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"return"),s(` imgBase64Url
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 生成导航模板"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"genTemplate"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("title"),n("span",{class:"token punctuation"},","),s("desc"),n("span",{class:"token punctuation"},","),s("link"),n("span",{class:"token punctuation"},","),s("icon")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},`
<a href="`),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("link"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},`" target="_blank" class="vp-card">
    <img class="vp-card-logo" src="`),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("icon"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},`">
    <div class="vp-card-content">
        <div class="vp-card-title">`),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("title"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},`</div>
        <hr/>
        <div class="vp-card-desc">`),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("desc"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},`</div>
    </div>
</a>
    `),n("span",{class:"token template-punctuation string"},"`")]),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// 存储icon，如果有存储，则使用存储，不发送请求"),s(`
`),n("span",{class:"token comment"},"// 写入文件，文件名使用不带协议的 icon 地址"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"saveIcon"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("name"),n("span",{class:"token punctuation"},","),s("content")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    fs`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"writeFile"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"icon/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".txt"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},","),s(" content"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("err"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
            console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," 的 icon 保存失败"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
            console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"error"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," 的 icon 保存成功"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"getIconContent"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"name"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"try"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"const"),s(" data "),n("span",{class:"token operator"},"="),s(" fs"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"readFileSync"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"icon/"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},".txt"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'utf8'"),n("span",{class:"token punctuation"},")"),s(`
        console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," 从内容中读取"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" data "),n("span",{class:"token operator"},"||"),s(),n("span",{class:"token string"},"''"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"catch"),s(),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," 文件没有被存储"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"false"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

module`),n("span",{class:"token punctuation"},"."),s("exports "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
    getIcon`),n("span",{class:"token punctuation"},","),s(`
    genTemplate
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),v=n("div",{class:"language-json line-numbers-mode","data-ext":"json"},[n("pre",{class:"language-json"},[n("code",null,[n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},'"description"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"scripts"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"start"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"node index.js"'),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token property"},'"dependencies"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token property"},'"axios"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^1.5.0"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"cheerio"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^1.0.0-rc.12"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"icojs"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^0.17.1"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token property"},'"node-xlsx"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"^0.23.0"'),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),b=n("div",{class:"language-text line-numbers-mode","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`上面设计的excel
`)]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),y=o('<h3 id="_4-使用方法" tabindex="-1"><a class="header-anchor" href="#_4-使用方法" aria-hidden="true">#</a> 4.使用方法</h3><ol><li>修改excel</li><li>安装依赖<code>npm i</code></li><li>运行<code>node index.js</code></li></ol><h3 id="_5-效果展示" tabindex="-1"><a class="header-anchor" href="#_5-效果展示" aria-hidden="true">#</a> 5.效果展示</h3><figure><img src="https://chart-1253420647.cos.ap-beijing.myqcloud.com/markdown/image-20230927181543663.png" alt="效果展示" tabindex="0" loading="lazy"><figcaption>效果展示</figcaption></figure>',4);function M(f,w){const c=l("CodeTabs");return i(),u("div",null,[d,r(c,{id:"86",data:[{id:"index.js"},{id:"utils.js"},{id:"package.json"},{id:"网站导航.xlsx"}],"tab-id":"shell"},{title0:a(({value:t,isActive:e})=>[s("index.js")]),title1:a(({value:t,isActive:e})=>[s("utils.js")]),title2:a(({value:t,isActive:e})=>[s("package.json")]),title3:a(({value:t,isActive:e})=>[s("网站导航.xlsx")]),tab0:a(({value:t,isActive:e})=>[m]),tab1:a(({value:t,isActive:e})=>[g]),tab2:a(({value:t,isActive:e})=>[v]),tab3:a(({value:t,isActive:e})=>[b]),_:1},8,["data"]),y])}const N=p(k,[["render",M],["__file","读取excel爬取对应网站生成导航信息.html.vue"]]);export{N as default};
